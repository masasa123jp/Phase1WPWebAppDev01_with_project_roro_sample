# RORO Plugins v1.5.0 – Release Notes
**Date:** 2025-08-26 (Asia/Tokyo)

## 概要
v1.5.0 は RORO プラグインスイートの安定版リリースです。DB スキーマの決定版を前提に、認証・地図・チャットボット・アドバイス・お気に入りに加え、**雑誌（Magazine）** と **おすすめ（Recommend）** を新規追加しました。本書は **変更点・互換性・既知の課題** に特化しており、**インストール手順や設定方法は含みません**（導入は別紙 *インストール手順 v1.5.0* を参照）。

> 注: 配布物の正確なファイル名・zip 一覧は *インストール手順 v1.5.0* を参照してください（本書では重複記載を避けています）。

## 主要変更点（プラグイン別）

### Core（roro-core-wp 0.4.0）
- 決定版 DDL を同梱（`assets/sql/schema/DDL_20250822.sql`）。
- 正準テーブルを `RORO_*` に統一、`wp_roro_*` は **互換ビュー** 化。
- 管理画面「Roro DB Setup」から **DDL → seed** の再実行が可能。
- 文字コードを `utf8mb4` / `utf8mb4_unicode_520_ci` に統一。

### Auth（roro-auth 1.0.0）
- ソーシャル連携の解除 UI（Google/LINE/Apple 等）を強化。
- **メール検証必須化**。未検証ユーザーの機能を制限。
- 通知テンプレートの最適化（件名/本文の多言語化フック）。
- ペット情報 CRUD／プロフィール画像アップロードの安定化。

### Map（roro-map 2.0.0）
- **自宅位置の GUI 保存**（既存の REST 保存に加えて対応）。
- マーカー **クラスタリング**／**距離ソート** を追加。
- お気に入り（Favorites）との連携性を向上。

### Chatbot（roro-chatbot 2.0.0）
- Dify 経由のストリーミング描画を最適化（逐次レンダリング）。
- 近傍スポットカードの JSON スキーマ準拠、map 連携で回答内にカード埋め込み。
- 自前モード／Dify 切替、チップ／カードの UI CSS/JS を強化。

### Advice（roro-advice 2.0.0）
- 内部 API を整理し、REST 未取得時のフォールバックメッセージを実装。
- 管理画面 UI を刷新（テーブルベースのアドバイス編集画面）。

### Favorites（roro-favorites 1.1.0）
- お気に入りを **DB 永続化**、重複登録防止のユニーク制約を追加。
- REST とショートコードの出力を多言語化。

### Magazine（roro-magazine 1.0.0） ※新規
- 月刊デジタル雑誌のカスタム投稿タイプ（号・記事）。
- ショートコード: `[roro_magazine]` / `[roro_mag_issue issue="latest"]` / `[roro_mag_article id="42"]`。

### Recommend（roro-recommend 1.0.0） ※新規
- 日替わりのおすすめスポット＋ワンポイントアドバイスを出力。
- ショートコード: `[roro_recommend]`（`show_advice="0"` でアドバイス非表示）。

## 互換性と移行
- v1.5.0 は v1.4.x 以前からの **上位互換** を想定。既存サイトに `wp_roro_*` 実体テーブルがある場合、DDL 適用前に `RORO_*` へ移行してください。
- MySQL 8.0+ を推奨。`CREATE VIEW` / `TRIGGER` 権限が必要です。
- WordPress 6.4+、PHP 8.3.21+ を推奨。

## 非推奨・破壊的変更
- `wp_roro_*` 実体テーブルの作成は廃止（ビューに置換）。
- Auth: メール未検証時の一部機能は使用不可（運用ポリシー強化）。

## セキュリティ／運用
- Nonce 検証、Capability チェック、出力エスケープを各所で強化。
- チャットボットの外部連携は API キーの **最小権限** を推奨。

## 既知の課題
- Seed データ投入は件数増で時間がかかる場合があります（段階投入を推奨）。
- Dify 接続は API キーとエンドポイント設定が必須。

## 付属物
- `checksums.txt`（各 Zip の SHA256）。
- スキーマ/シード SQL（core 同梱）。

---
*本ドキュメントは、既存の v1.6 系資料を参考に、重複を排して v1.5.0 用に再構成しています（詳細は同梱のインストール手順をご参照ください）。*
